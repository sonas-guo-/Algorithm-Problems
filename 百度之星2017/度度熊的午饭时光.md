# 题目链接
度度熊的午饭时光[]
# 思路

# 代码
#define MAXB 1005
#define MAXN 105
	struct Plan
	{
		int score;
		int idsum;
		vector<int> plan;
		Plan() {
			score = 0;
			idsum = 0;
		};
	};
	Plan f[MAXN][MAXB];
	int score[MAXN], price[MAXN];
	int main() {

	#ifdef DEBUG
		ifstream cin("in.txt");
		ofstream cout("out.txt");
		//freopen("in.txt", "r", stdin);
		//freopen("out.txt", "w", stdout);
	#endif
		int T,N,B;
		cin >> T;
		for (size_t t = 1; t <= T; t++)
		{
			fill_n(f[0], MAXN*MAXB, Plan());
			cin >> B >> N;
			for (int i = 1; i <= N; i++)
				cin >> score[i] >> price[i];

			for (int i = 1; i <= N; i++)
			{
				for (int j = 0; j <=B; j++)
				{
					//dont select
					if (f[i - 1][j].score > f[i][j].score)
					{
						f[i][j] = f[i - 1][j];
					}
					else if (f[i - 1][j].score == f[i][j].score)
					{
						if (f[i - 1][j].idsum < f[i][j].idsum)
						{
							f[i][j] = f[i - 1][j];
						}
					}
					//select
					if (j - price[i] >= 0)
					{
						if (f[i - 1][j - price[i]].score + score[i] > f[i][j].score)
						{
							f[i][j].score = f[i - 1][j - price[i]].score + score[i];
							f[i][j].idsum = f[i - 1][j - price[i]].idsum + i;
							f[i][j].plan = f[i - 1][j - price[i]].plan;
							f[i][j].plan.emplace_back(i);
						}
						if (f[i - 1][j - price[i]].score + score[i] == f[i][j].score)
						{
							if (f[i][j].idsum > f[i - 1][j - price[i]].idsum + i)
							{
								f[i][j].idsum = f[i - 1][j - price[i]].idsum + i;
								f[i][j].plan = f[i - 1][j - price[i]].plan;
								f[i][j].plan.emplace_back(i);
							}
						}
					}
				}
			}
			int cost = 0;
			cout << "Case #" << t << ":" << endl;
			for (size_t i = 0; i < f[N][B].plan.size(); i++)
				cost += price[f[N][B].plan[i]];
			cout << f[N][B].score <<' '<<cost<< endl;
			if (f[N][B].plan.size() != 0)
			{
				for (size_t i = 0; i < f[N][B].plan.size(); i++)
				{
					if (i)
						cout << ' ' << f[N][B].plan[i];
					else
						cout << f[N][B].plan[i];
				}
				cout << endl;
			}
		}
		return 0;
	}